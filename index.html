<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>KraftList ‚Äî Online</title>
<style>
:root{
  --bg1:#021024; --bg2:#06325a; --accent:#7c3aed; --muted:#94a3b8;
  --maxwidth:1200px; font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
}
*{box-sizing:border-box}
body{margin:0;min-height:100vh;color:#e6eef8;
  background:linear-gradient(-45deg,var(--bg1),var(--bg2),#0b2a5a,var(--bg1));
  background-size:400% 400%;animation:gradientMove 25s linear infinite alternate;
  display:flex;justify-content:center;}
@keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
.wrap{width:100%;max-width:var(--maxwidth);margin:28px auto;padding:24px;position:relative}
.corner{position:absolute;top:8px;right:12px;font-size:12px;color:var(--muted)}
header{display:flex;align-items:center;gap:12px;margin-bottom:18px}
.logo{width:56px;height:56px;border-radius:10px;display:grid;place-items:center;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.04);font-weight:800}
h1{font-size:20px;margin:0}
.nav{display:flex;gap:8px;margin:16px 0;overflow-x:auto;position:relative}
.indicator{position:absolute;height:100%;border-radius:999px;background:rgba(124,58,237,0.18);transition:all .35s ease;z-index:0}
.tab{position:relative;z-index:1;padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,0.04);cursor:pointer;font-weight:700;background:transparent;color:white;transition:transform .15s}
.tab:active{transform:scale(.98)}
.controls{display:flex;gap:8px;margin-bottom:12px}
.search{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:white}
.btn{padding:10px 12px;border-radius:10px;border:0;background:var(--accent);cursor:pointer;color:white;font-weight:700}
.player-list{display:flex;flex-direction:column;gap:10px;padding:0;margin:0;list-style:none}
.player-item{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;background:rgba(0,0,0,0.25);border:1px solid rgba(255,255,255,0.03)}
.player-rank{font-weight:900;min-width:48px}
.gold{color:#ffd700}
.silver{color:#c0c0c0}
.bronze{color:#cd7f32}
.player-box{width:44px;height:36px;border:2px solid rgba(255,255,255,0.06);border-radius:6px;background:rgba(255,255,255,0.02)}
.player-name{font-weight:700}
.player-points{color:var(--muted);font-size:13px}
.player-extra{font-size:12px;color:#cbd5f5}
.delete-btn{margin-left:auto;background:#ef4444;border:none;border-radius:6px;padding:6px 8px;cursor:pointer;color:white}
.slide-out{animation:slideOut .25s forwards}
.slide-in{animation:slideIn .35s ease}
@keyframes slideOut{from{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(-60px)}}
@keyframes slideIn{from{opacity:0;transform:translateX(60px)}to{opacity:1;transform:translateX(0)}}
footer{color:var(--muted);font-size:13px;margin-top:18px;text-align:center}
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.7);z-index:80}
.modal.open{display:flex}
.form{background:#081427;padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);width:420px;max-width:92%;display:flex;flex-direction:column;gap:8px}
label{font-size:13px;color:var(--muted)}
input,select{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
.small{font-size:12px;color:var(--muted)}
</style>
</head>
<body>
  <div class="wrap">
    <div class="corner">Propiedad De Kraftune Studios</div>

    <header>
      <div class="logo">KL</div>
      <div>
        <h1>KraftList</h1>
        <div class="small">PvP ¬∑ Rankings ¬∑ Servidor</div>
      </div>
    </header>

    <nav class="nav" id="nav"><div class="indicator" id="indicator"></div></nav>

    <div class="controls">
      <input id="search" class="search" placeholder="Buscar jugador..." />
      <button id="addBtn" class="btn">+ A√±adir</button>
    </div>

    <div id="content" class="content-wrap"></div>

    <footer>Hecho por MakApagado24</footer>
  </div>

  <div class="modal" id="modal" aria-hidden="true">
    <div class="form" role="dialog">
      <h3>‚öîÔ∏è A√±adir Jugador</h3>
      <label>Nombre</label>
      <input id="f-name" placeholder="Nombre" />
      <label>Categor√≠a</label>
      <select id="f-cat"></select>
      <label>Puntos</label>
      <input id="f-points" type="number" placeholder="Puntos" />
      <label>Descripci√≥n (solo eventos/discord/finalistas)</label>
      <input id="f-desc" placeholder="Descripci√≥n (opcional)" />
      <label>Link (solo PvP u otras modalidades)</label>
      <input id="f-link" placeholder="https://..." />
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:8px">
        <button id="cancel" class="btn" style="background:#334155">Cancelar</button>
        <button id="save" class="btn">Guardar</button>
      </div>
    </div>
  </div>

<!-- SCRIPT: Firebase + l√≥gica de la p√°gina -->
<script type="module">
/*
  C√≥digo completo: Firebase (Firestore) + UI
  - Aseg√∫rate de tener Firestore creado y reglas temporales allow read, write: if true;
*/

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import {
  getFirestore, collection, addDoc, deleteDoc, doc, onSnapshot, query, orderBy
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* --- Config Firebase (tu proyecto) --- */
const firebaseConfig = {
  apiKey: "AIzaSyB2cmVDJyoT_i9cMCz3D3iM2GGwkrZnw0E",
  authDomain: "kraftlist-659e2.firebaseapp.com",
  projectId: "kraftlist-659e2",
  storageBucket: "kraftlist-659e2.firebasestorage.app",
  messagingSenderId: "867558321438",
  appId: "1:867558321438:web:1f02a59488584efdc06d0f"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* --- Categor√≠as y configuraciones --- */
const cats = [
  'PvP','Mace','BuildUHC','Nodebuff','Battleground','CrystalPvP',
  'Ganadores de Eventos','Mejor del Server de Discord','Finalistas'
];
const descCats = new Set(['Ganadores de Eventos','Mejor del Server de Discord','Finalistas']);

/* --- Estado de la app --- */
let active = cats[0];
let data = [];       // datos locales sincronizados con Firestore
let isAdmin = false; // modo admin (activar con F9 o al pulsar + A√±adir)

const nav = document.getElementById('nav');
const indicator = document.getElementById('indicator');
const content = document.getElementById('content');
const search = document.getElementById('search');
const modal = document.getElementById('modal');

/* --- Inicializa el select del modal con categor√≠as --- */
const catSelect = document.getElementById('f-cat');
cats.forEach(c => { const o = document.createElement('option'); o.value = c; o.textContent = c; catSelect.appendChild(o); });

/* --- Utilidades --- */
function ordinalSuffix(i){
  const j = i % 10, k = i % 100;
  if(k >= 11 && k <= 13) return 'th';
  if(j === 1) return 'st';
  if(j === 2) return 'nd';
  if(j === 3) return 'rd';
  return 'th';
}
function rankClass(i){
  if(i === 0) return 'gold';
  if(i === 1) return 'silver';
  if(i === 2) return 'bronze';
  return '';
}

/* --- Navegaci√≥n (tabs) con indicador animado --- */
function moveIndicator(el){
  const rect = el.getBoundingClientRect();
  const navRect = nav.getBoundingClientRect();
  indicator.style.width = rect.width + 'px';
  indicator.style.left = (rect.left - navRect.left) + 'px';
}
function renderNav(){
  nav.querySelectorAll('.tab').forEach(e => e.remove());
  cats.forEach(c => {
    const b = document.createElement('button');
    b.className = 'tab' + (c === active ? ' active' : '');
    b.textContent = c;
    b.onclick = () => { active = c; render(true); moveIndicator(b); };
    nav.appendChild(b);
    if(c === active) setTimeout(()=>moveIndicator(b), 0);
  });
}

/* --- Render lista (local, basada en "data") --- */
function drawList(list){
  content.innerHTML = '';
  const ul = document.createElement('ul');
  ul.className = 'player-list';
  list.forEach((p, i) => {
    const li = document.createElement('li');
    li.className = 'player-item';
    const rc = rankClass(i);
    let extra = '';
    if(descCats.has(p.cat)) extra = p.desc || '';
    else extra = p.link || '';

    li.innerHTML = `
      <div class='player-rank ${rc}'>${i+1}${ordinalSuffix(i+1)}</div>
      <div class='player-box'></div>
      <div>
        <div class='player-name'>${p.name}</div>
        <div class='player-points'>${p.points} pts</div>
        <div class='player-extra'>${extra}</div>
      </div>
    `;
    if(isAdmin){
      const del = document.createElement('button');
      del.className = 'delete-btn';
      del.textContent = 'üóë';
      del.onclick = async () => {
        // borrar en Firestore
        await deleteDoc(doc(db, "players", p.id));
      };
      li.appendChild(del);
    }
    ul.appendChild(li);
  });
  content.appendChild(ul);
}

/* --- render principal (con slide opcional) --- */
function render(slide = false){
  renderNav();
  const q = (search.value || '').trim().toLowerCase();
  const list = data
    .filter(d => d.cat === active && d.name.toLowerCase().includes(q))
    .sort((a,b) => b.points - a.points);

  if(slide){
    content.classList.add('slide-out');
    setTimeout(()=>{
      drawList(list);
      content.classList.remove('slide-out');
      content.classList.add('slide-in');
      setTimeout(()=>content.classList.remove('slide-in'), 350);
    }, 220);
  } else {
    drawList(list);
  }
}

/* --- b√∫squeda --- */
search.addEventListener('input', () => render());

/* --- + A√±adir: pedir contrase√±a si no admin --- */
document.getElementById('addBtn').onclick = () => {
  if(!isAdmin){
    const pass = prompt("Contrase√±a admin:");
    if(pass === "kraftadmin123"){
      isAdmin = true;
      alert("Modo admin activado");
    } else {
      alert("Contrase√±a incorrecta");
      return;
    }
  }
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
};

/* --- cancelar modal --- */
document.getElementById('cancel').onclick = () => {
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
};

/* --- Guardar nuevo jugador (a√±ade a Firestore) --- */
document.getElementById('save').onclick = async () => {
  if(!isAdmin){ alert("Solo admin"); return; }
  const name = document.getElementById('f-name').value.trim();
  const cat = document.getElementById('f-cat').value;
  const points = parseInt(document.getElementById('f-points').value) || 0;
  const desc = document.getElementById('f-desc').value.trim();
  const link = document.getElementById('f-link').value.trim();
  if(!name){ alert('Pon nombre'); return; }
  await addDoc(collection(db, "players"), { name, cat, points, desc, link });
  document.getElementById('f-name').value = '';
  document.getElementById('f-points').value = '';
  document.getElementById('f-desc').value = '';
  document.getElementById('f-link').value = '';
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
};

/* --- activar admin con F9 (atajo) --- */
window.addEventListener('keydown', e => {
  if(e.key === 'F9'){
    const pass = prompt("Contrase√±a admin:");
    if(pass === "kraftadmin123"){
      isAdmin = true;
      alert("Modo admin activado");
      render();
    } else {
      alert("Contrase√±a incorrecta");
    }
  }
});

/* --- Firestore realtime: escucha colecci√≥n 'players' ordenada por points desc --- */
const q = query(collection(db, "players"), orderBy("points", "desc"));
onSnapshot(q, snapshot => {
  data = [];
  snapshot.forEach(d => data.push({ id: d.id, ...d.data() }));
  render(); // re-render cada vez que cambian datos en Firestore
});

/* --- inicial render --- */
render();
</script>
</body>
</html>



